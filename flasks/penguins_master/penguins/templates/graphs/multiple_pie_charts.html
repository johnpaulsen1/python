<!doctype html>
<link rel="stylesheet" href="/static/style.css" type="text/css">
<link rel="stylesheet" href="/static/style/graphs-style.css" type="text/css">
<head>
  <title>{{ title }}</title>
  <script src="/static/javascript/colour_randomiser.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.0/Chart.bundle.js" integrity="sha512-vJLAMsHIpI7ORUMpudTJNz+wRNnPQAkHVlnpgpVxXI0lPnKcQ38Psu0APJ2r3nhhBHNIcQPRVrlkHiAeQHADTA==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/chart.piecelabel.js/0.15.0/Chart.PieceLabel.min.js" integrity="sha512-pLEKa6g1uR205lfWRPuxwUa/aw1Yge1jOCvYr5WCL68gh3FoLi0eqMsIEtCvIXgZY0LwiRoMgiTfrpX7pK1HFA==" crossorigin="anonymous"></script>
</head>

<body>
  <form method="POST">
    <div class="graph_menu-screen">
    <center>
      <h2>{{ title }}</h2>
    </center>
    <div class="control-group-small radio-buttons-label">
      <p>Please select graph type:</p>
    </div>
    <div class="control-group-small general-radio-buttons">
      <input type="radio" id="bar" name="graph_type" value="Bar Graph" onclick="handleClick(this);">
      <label class="radio-labels" for="bar">Bar Graph</label><br>

      <input type="radio" id="pie" name="graph_type" value="Pie Graph" checked onclick="handleClick(this);">
      <label class="radio-labels" for="pie">Pie Graph</label><br>
    </div>
    {% for graph_legend, multi_graphs_values in multiple_graphs_dict.items() %}
      <center>
        <div class="control-group">
          <div class="graph_padding">
            <canvas id="{{ graph_legend }}"></canvas>
          </div>
        </div>
      </center>
      <script>

      var prev_radio_value = 0;

      function handleClick(myRadio) {
        var static_bar_value = "Bar Graph"
        var static_pie_value = "Pie Graph"

        if (prev_radio_value != static_bar_value && myRadio.value == static_bar_value){
          window.location.href = "{{url_for('multi_bars')}}"
          prev_radio_value = myRadio.value
        }
        else if (prev_radio_value != static_pie_value && myRadio.value == static_pie_value){
          window.location.href = "{{url_for('multi_pies')}}"
          prev_radio_value = myRadio.value
        }
      }

      var ctx = document.getElementById("{{ graph_legend }}").getContext('2d');
      ctx.font = Chart.helpers.fontString(Chart.defaults.global.defaultFontColor="#a64b00",
                                          Chart.defaults.global.defaultFontFamily
                                        );

      var myChart = new Chart(ctx, {
        type: 'pie',
        data: {
          labels: [
            {% for label in multi_graphs_values.keys() %}
              "{{ label }}",
            {% endfor %}
          ],
          datasets: [{
            label: '{{ graph_legend }}',
            data: [
              {% for value in multi_graphs_values.values() %}
                "{{ value }}",
              {% endfor %}
            ],
            backgroundColor: [
              {% for value in multi_graphs_values.values() %}
               getRandomCyanColour(),
              {% endfor %}
            ],
            borderColor: [
              {% for value in multi_graphs_values.values() %}
               getRandomOrangeColour(),
              {% endfor %}
            ]
          }]
        },
        options: {
          title: {
            display: true,
            text: "{{ graph_legend }}",
            fontSize: 20
          },
          pieceLabel: {
            mode: "value",
            fontSize: 14,
            fontStyle: 'bold',
            position: 'outside',
            // overlap: true,
            // showActualPercentages: true,
          }
        }
      });
      </script>
    {% endfor %}
    <div class="control-group">
      <input type="submit" value="Back" class="floated_left_btn btn btn-back" name="submit_button">
      <input type="submit" value="Log Out" class="floated_right_btn btn btn-logout" name="submit_button">
    </div>
    </div>
  </form>
</body>
